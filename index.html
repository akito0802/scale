
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tber Scale Viewer - Full Restored</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; background: #f9f9f9; }
    select, table { margin: 1rem 0; padding: 0.5rem; font-size: 1rem; }
    .description { margin-top: 2rem; padding: 1rem; background: #fff; border-radius: 8px; }
    table { border-collapse: collapse; width: 100%; background: white; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  </style>
</head>
<body>
  <h1>Tber Scale Viewer</h1>
  <label for="key">Key:</label>
  <select id="key"></select>

  <label for="group">分類:</label>
  <select id="group"></select>

  <label for="scale">スケール:</label>
  <select id="scale"></select>

  <div id="output">
    <table id="notes-table"></table>
    <div id="description" class="description"></div>
  </div>

  <script>
    const data = {
      "C": {
        "メジャー": {
          "メジャースケール": {
            notes: [["1", "C"], ["2", "D"], ["3", "E"], ["4", "F"], ["5", "G"], ["6", "A"], ["7", "B"]],
            description: "明るく安定した印象を持ち、音楽の基礎となるスケール。全ての白鍵を使う。"
          },
          "メジャーペンタトニック": {
            notes: [["1", "C"], ["2", "D"], ["3", "E"], ["5", "G"], ["6", "A"]],
            description: "5音構成で明るくシンプルな響き。フォークやポップスに多用される。"
          }
        },
        "チャーチモード": {
          "アイオニアン（Ionian）": {
            notes: [["1", "C"], ["2", "D"], ["3", "E"], ["4", "F"], ["5", "G"], ["6", "A"], ["7", "B"]],
            description: "メジャースケールと同じ構成で、明るくバランスが良いモード。"
          },
          "ドリアン（Dorian）": {
            notes: [["1", "C"], ["2", "D"], ["♭3", "Eb"], ["4", "F"], ["5", "G"], ["6", "A"], ["♭7", "Bb"]],
            description: "ナチュラルマイナーに似ているが6度がメジャー。ジャズやファンクで使われる。"
          },
          "フリジアン（Phrygian）": {
            notes: [["1", "C"], ["♭2", "Db"], ["♭3", "Eb"], ["4", "F"], ["5", "G"], ["♭6", "Ab"], ["♭7", "Bb"]],
            description: "エキゾチックで暗く緊張感のある響き。スペイン音楽などに使われる。"
          },
          "リディアン（Lydian）": {
            notes: [["1", "C"], ["2", "D"], ["3", "E"], ["#4", "F#"], ["5", "G"], ["6", "A"], ["7", "B"]],
            description: "メジャースケールに#4を加えた浮遊感のある響き。映画音楽にも多い。"
          },
          "ミクソリディアン（Mixolydian）": {
            notes: [["1", "C"], ["2", "D"], ["3", "E"], ["4", "F"], ["5", "G"], ["6", "A"], ["♭7", "Bb"]],
            description: "メジャースケールに♭7を加えたブルージーな印象。ロックなどで多用。"
          },
          "エオリアン（Aeolian）": {
            notes: [["1", "C"], ["2", "D"], ["♭3", "Eb"], ["4", "F"], ["5", "G"], ["♭6", "Ab"], ["♭7", "Bb"]],
            description: "ナチュラルマイナーと同じ構成。哀愁のある音階。"
          },
          "ロクリアン（Locrian）": {
            notes: [["1", "C"], ["♭2", "Db"], ["♭3", "Eb"], ["4", "F"], ["♭5", "Gb"], ["♭6", "Ab"], ["♭7", "Bb"]],
            description: "不安定で緊張感が強く、独特なサウンド。"
          }
        }
      }
    };

    const keySelect = document.getElementById("key");
    const groupSelect = document.getElementById("group");
    const scaleSelect = document.getElementById("scale");
    const notesTable = document.getElementById("notes-table");
    const descriptionBox = document.getElementById("description");

    function updateKeyOptions() {
      keySelect.innerHTML = "";
      for (let key in data) {
        const opt = document.createElement("option");
        opt.value = key;
        opt.textContent = key;
        keySelect.appendChild(opt);
      }
    }

    function updateGroupOptions(key) {
      groupSelect.innerHTML = "";
      for (let group in data[key]) {
        const opt = document.createElement("option");
        opt.value = group;
        opt.textContent = group;
        groupSelect.appendChild(opt);
      }
    }

    function updateScaleOptions(key, group) {
      scaleSelect.innerHTML = "";
      for (let scale in data[key][group]) {
        const opt = document.createElement("option");
        opt.value = scale;
        opt.textContent = scale;
        scaleSelect.appendChild(opt);
      }
    }

    function updateDisplay(key, group, scale) {
      const scaleData = data[key][group][scale];
      if (!scaleData) return;
      const notes = scaleData.notes;
      const desc = scaleData.description;
      let headerRow = "<tr>";
      let valueRow = "<tr>";
      notes.forEach(note => {
        headerRow += `<th>${note[0]}</th>`;
        valueRow += `<td>${note[1]}</td>`;
      });
      headerRow += "</tr>";
      valueRow += "</tr>";
      notesTable.innerHTML = headerRow + valueRow;
      descriptionBox.textContent = desc;
    }

    keySelect.addEventListener("change", () => {
      const currentGroup = groupSelect.value;
      const currentScale = scaleSelect.value;
      updateGroupOptions(keySelect.value);
      if (data[keySelect.value][currentGroup]) {
        groupSelect.value = currentGroup;
        updateScaleOptions(keySelect.value, currentGroup);
        if (data[keySelect.value][currentGroup][currentScale]) {
          scaleSelect.value = currentScale;
          updateDisplay(keySelect.value, currentGroup, currentScale);
        }
      }
    });

    groupSelect.addEventListener("change", () => {
      updateScaleOptions(keySelect.value, groupSelect.value);
      updateDisplay(keySelect.value, groupSelect.value, scaleSelect.value);
    });

    scaleSelect.addEventListener("change", () => {
      updateDisplay(keySelect.value, groupSelect.value, scaleSelect.value);
    });

    updateKeyOptions();
    updateGroupOptions("C");
    updateScaleOptions("C", "メジャー");
    updateDisplay("C", "メジャー", "メジャースケール");
  </script>
</body>
</html>
